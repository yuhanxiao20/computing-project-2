---
title: "Project 2"
author: "Yuhan Xiao"
output: html_document
date: "2023-10-01"
---

## Background 
```{r message = FALSE}
```

## Part 1: Fun with functions
#### Part 1A: Exponential transformation
```{r part1A}
# define a function Exp(x,k) that computes the exponential of a number using the truncated series expansion
# parameters
# x : the number to be exponentiated
# k : the number of terms to be used in the series expansion beyond the constant 1, k is always >= 1
Exp <- function(x,k) {
  output = 1
  count = 1
  while (count <= k) {
    output = output + (x^count)/factorial(count)
    count = count + 1
  }
  output
}

# an example using function Exp(x,k)
Exp(2,15)
# compare with actual exp() function in R
exp(2)
```

#### Part 1B: Sample mean and sample standard deviation
```{r part1B}
# define a function sample_mean(x) that calculates the sample average for a vector of data of length N
# parameter
# x : a vector of numbers of length N
sample_mean <- function(x) {
  N = length(x)
  output = sum(x) / N
  output
} 

# define a function sample_sd(x) that calculates the sample standard deviation for a vector of data of length N
# parameter
# x : a vector of numbers of length N
sample_sd <- function(x) {
  N = length(x)
  avg = sum(x) / N
  output = 0
  for (i in 1:N) {
    output = output + (x[i] - avg)^2
  }
  output = sqrt(output/(N-1))
  output
}

# an example using functions sample_mean(x) and sample_sd(x)
x = c(1,2)
sample_mean(x)
sample_sd(x)
# compare with actual mean() and sd() functions in R
mean(x)
sd(x)
```

#### Part 1C: Confidence intervals
```{r part1C}
# define a function calculate_CI(x, conf) that calculates the confidence interval for a vector of data of length N
# parameter
# x : a vector of numbers of length N
# conf : = (1-alpha) allows the confidence interval to be adapted for different alpha, with a default value of 0.95
calculate_CI <- function(x, conf = 0.95) {
  alpha = 1 - conf
  N = length(x)
  degrees_freedom = N - 1
  t_score = qt(p = alpha / 2, df = degrees_freedom, lower.tail = FALSE)
  avg = mean(x)
  se = sd(x)/sqrt(N)
  output = c(avg - t_score*se, avg + t_score*se)
  output
}

# an example using calculate_CI(x, conf)
x = c(1,2,3,4,5,6)
calculate_CI(x)
# compare with existing confint() function in R
dat <- data.frame(x = x)
fit <- lm(x ~ 1, dat)
## Calculate a 95% confidence interval
confint(fit, level = 0.95)
```